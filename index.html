<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>sedna FM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(ellipse at center, #3a3d43 0%, #23252a 100%);
      font-family: 'Courier New', Courier, monospace;
      color: #fff;
      overflow-x: hidden;
      /* Subtle noise overlay for texture */
      position: relative;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      pointer-events: none;
      opacity: 0.18;
      z-index: 0;
      background: url('https://www.transparenttextures.com/patterns/diamond-upholstery.png');
      /* fallback: subtle noise pattern */
    }
    .nav-bar {
      width: 100vw;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 32px 24px 0 24px;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 10;
    }
    .nav-left {
      display: flex;
      gap: 2rem;
      font-size: 1.2rem;
    }
    .nav-left a {
      color: #fff;
      text-decoration: none;
      opacity: 0.85;
      transition: opacity 0.2s;
    }
    .nav-left a:hover {
      opacity: 1;
      text-decoration: underline;
    }
    .site-title {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'Dancing Script', cursive, sans-serif;
      font-size: 2rem;
      letter-spacing: 0.1em;
      opacity: 0.9;
      top: 32px;
    }
    .nav-right {
      display: flex;
      gap: 1.2rem;
      font-size: 1.7rem;
      align-items: center;
      position: relative;
      z-index: 20;
      background: rgba(35, 37, 42, 0.85);
      padding: 6px 12px;
      border-radius: 16px;
      box-shadow: 0 2px 8px #0004;
      margin-right: 32px;
    }
    .nav-right a {
      color: #fff;
      opacity: 0.9;
      transition: opacity 0.2s;
      text-decoration: none;
      padding: 4px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .nav-right a:hover {
      opacity: 1;
      background: #ff5500;
      color: #fff;
    }
    #radio-hero {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    #radio-label {
      margin-top: 20px;
      font-size: 2rem;
      color: #fff;
      letter-spacing: 0.1em;
      text-shadow: 0 2px 8px #0008;
    }
    #soundcloud-player {
      margin-top: 32px;
      display: block;
      width: 100%;
      max-width: 500px;
      min-height: 0;
      height: 0;
      overflow: hidden;
      position: absolute;
      left: -9999px;
      top: -9999px;
      pointer-events: none;
      opacity: 0;
    }
  </style>
  <style>
    #radio-ui-wrapper {
      max-width: 98vw;
      width: 500px;
      margin: 0 auto;
      position: relative;
    }
    #radio-black-overlay {
      transition: all 0.2s;
      /* box-shadow removed for transparent background */
      overflow: hidden;
      padding-right: 8px;
    }
    #radio-artwork {
      box-shadow: 0 2px 8px #0007;
      background: #222;
      border-radius: 12px;
      object-fit: cover;
      min-width: 44px;
      min-height: 44px;
      max-width: 56px;
      max-height: 56px;
      aspect-ratio: 1/1;
      margin-left: 12px;
      flex-shrink: 0;
      /* display: none; */
    }
    #radio-title-container {
      overflow: hidden;
      white-space: nowrap;
      position: relative;
      max-width: 300px;
      min-width: 0;
      display: flex;
      align-items: center;
      height: 56px;
    }
    #radio-title {
      display: inline-block;
      vertical-align: middle;
      font-size: 1.45rem;
      font-weight: bold;
      color: #fff;
      line-height: 1.2;
      text-shadow: 0 2px 8px #000a;
      will-change: transform;
      transition: color 0.2s;
      padding-left: 2px;
      padding-right: 0;
      max-width: 100%;
    }
    #radio-controls button:active {
      filter: brightness(0.95);
    }
    #radio-controls button:focus {
      outline: 2px solid #ff5252;
      outline-offset: 2px;
    }
    @media (max-width: 600px) {
      #radio-ui-wrapper { width: 99vw; }
      #radio-black-overlay { left: 2vw; width: 95vw; }
      #radio-artwork { width: 44px; height: 44px; }
      #radio-title-container { max-width: 60vw; }
      /* Responsive button positions for mobile */
      #radio-play-btn {
        left: 44vw !important;
        top: 38vw !important;
        width: 44px !important;
        height: 44px !important;
      }
      #radio-next-btn {
        left: 60vw !important;
        top: 41vw !important;
        width: 36px !important;
        height: 36px !important;
      }
    }
    @keyframes scroll-title {
      0% { transform: translateX(0); }
      10% { transform: translateX(0); }
      90% { transform: translateX(calc(-1 * (var(--scroll-distance, 0px)))); }
      100% { transform: translateX(0); }
    }
  </style>
  <style>
    /* Modal styles for Microsoft Form */
    .modal-overlay {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(30, 32, 36, 0.85);
      justify-content: center;
      align-items: center;
    }
    .modal-overlay.active {
      display: flex;
    }
    .modal-window {
      background: #23252a;
      border-radius: 14px;
      box-shadow: 0 4px 32px #000b;
      padding: 0;
      min-width: 0;
      width: 620px;
      max-width: 99vw;
      min-height: 720px;
      max-height: 99vh;
      color: #fff;
      position: relative;
      font-family: 'Courier New', Courier, monospace;
      animation: modalIn 0.18s cubic-bezier(.4,2,.6,1) both;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    @keyframes modalIn {
      from { transform: translateY(40px) scale(0.98); opacity: 0; }
      to   { transform: none; opacity: 1; }
    }
    .modal-close {
      position: absolute;
      top: 10px; right: 18px;
      background: none;
      border: none;
      color: #fff;
      font-size: 1.7rem;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s;
      z-index: 2;
    }
    .modal-close:hover {
      opacity: 1;
    }
    .modal-iframe-container {
      width: 520px;
      max-width: 94vw;
      height: 600px;
      max-height: 85vh;
      min-height: 600px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #23252a;
      border-radius: 14px;
      overflow: hidden;
      position: relative;
      padding-top: 32px; /* Add space above the form */
      box-sizing: border-box;
    }
    @media (max-width: 700px) {
      .modal-iframe-container {
        width: 98vw;
        height: 80vw;
        min-height: 340px;
        max-height: 85vh;
      }
    }
    @media (max-width: 600px) {
      .modal-window {
        min-width: 0;
        padding: 0;
      }
      .modal-iframe-container {
        width: 99vw;
        height: 90vw;
        min-height: 320px;
        max-height: 80vh;
      }
    }
  </style>
  <!-- Google Fonts for site title (optional, for script style) -->
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
  <!-- Font Awesome for social icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <!-- SoundCloud Widget API -->
  <script src="https://w.soundcloud.com/player/api.js"></script>
  <style>
    /* Store button bottom left */
    #store-btn {
      position: fixed;
      left: 32px;
      bottom: 32px;
      background: #111c;
      color: #fff;
      font-family: 'Courier New', Courier, monospace;
      font-size: 1.2rem;
      padding: 8px 22px;
      border-radius: 4px;
      border: none;
      box-shadow: 0 2px 8px #0007;
      cursor: pointer;
      z-index: 20;
      letter-spacing: 0.04em;
      font-weight: bold;
      transition: background 0.2s, color 0.2s;
      text-decoration: none;
      outline: none;
    }
    #store-btn:hover {
      background: #fff;
      color: #23252a;
    }
    @media (max-width: 600px) {
      #radio-svg { width: 98vw; height: auto; }
      #store-btn { left: 10px; bottom: 10px; font-size: 1rem; padding: 6px 14px; }
      .nav-bar { padding: 12px 4vw 0 4vw; }
      .site-title { font-size: 1.2rem; }
      .nav-right {
        font-size: 1.3rem;
        gap: 0.7rem;
        padding: 4px 8px;
        margin-right: 8px;
      }
    }
  </style>
</head>
<body>
  <nav class="nav-bar">
    <div class="nav-left">
      <a href="#">subscribe</a>
      <a href="about.html">About Us</a>
    </div>
    <!-- site-title removed as per user request -->
    <div class="nav-right">
      <a href="https://instagram.com/sednafm" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
      <a href="https://soundcloud.com/sednafm" target="_blank" title="SoundCloud"><i class="fab fa-soundcloud"></i></a>
    </div>
  </nav>
  <!-- store button removed as requested -->
  <div id="radio-hero">
    <div id="radio-ui-wrapper" style="position:relative; width:500px; max-width:98vw; margin:0 auto;">
      <img id="radio-img" src="radio.png" alt="Radio" style="width:100%; display:block; z-index:1;">
      <!-- Overlay: black area for artwork and title -->
      <div id="radio-black-overlay" style="position:absolute; left:48px; top:225px; width:404px; height:70px; background:transparent; border-radius:0; display:none; align-items:center; z-index:2;">
        <a id="radio-artwork-link" href="#" target="_blank" style="display: flex;">
          <img id="radio-artwork" src="ale1.jpeg" alt="Artwork" style="width:56px; height:56px; border-radius:12px; object-fit:cover; margin-left:12px; background:#333; flex-shrink:0;">
        </a>
        <div id="radio-title-container" style="flex:1; margin-left:18px; margin-right:18px; overflow:hidden; white-space:nowrap; position:relative;">
          <span id="radio-title" style="font-size:1.45rem; font-weight:bold; color:#fff; display:inline-block; vertical-align:middle; line-height:1.2; text-shadow:0 2px 8px #000a;"></span>
        </div>
      </div>
      <!-- Overlay: play and next buttons -->
      <div id="radio-controls" style="position:absolute; left:0; top:0; width:100%; height:100%; z-index:3; pointer-events:none;">
        <!-- Play button: perfectly overlap the play button in the radio image -->
        <button id="radio-play-btn"
          style="position:absolute; left:50%; top:70.1%; transform:translate(-50%,-50%); width:76px; height:76px; border-radius:50%; background:#ff5252; border:6px solid #fff; box-shadow:0 2px 8px #0008; display:flex; align-items:center; justify-content:center; cursor:pointer; outline:none; transition:background 0.2s; pointer-events:auto;">
          <span id="play-icon" style="display:block;">
            <svg width="38" height="38" viewBox="0 0 32 32"><polygon points="10,7 26,16 10,25" fill="#fff"/></svg>
          </span>
          <span id="pause-icon" style="display:none;">
            <svg width="38" height="38" viewBox="0 0 32 32"><rect x="10" y="7" width="5" height="18" rx="2" fill="#fff"/><rect x="17" y="7" width="5" height="18" rx="2" fill="#fff"/></svg>
          </span>
        </button>
        <!-- Next button: perfectly overlap the next button in the radio image -->
        <button id="radio-next-btn"
          style="position:absolute; left:calc(50% + 52px); top:68.5%; width:38px; height:38px; border-radius:50%; background:#fff; border:4px solid #bbb; box-shadow:0 2px 8px #0005; display:flex; align-items:center; justify-content:center; cursor:pointer; outline:none; transition:background 0.2s; pointer-events:auto;">
          <svg width="32" height="32" viewBox="0 0 28 28">
            <polygon points="8,6 20,14 8,22" fill="#888"/>
            <polygon points="15,6 27,14 15,22" fill="#bbb" opacity="0.7"/>
          </svg>
        </button>
      </div>
    </div>
    <div id="radio-label" style="display: flex; flex-direction: column; align-items: center;">
      Sedna FM
      <img src="sedna_logo.png" alt="Sedna FM Logo" style="margin-top: 12px; width: 60px; height: auto;">
    </div>
    <div id="soundcloud-player"></div>
  </div>
  <script>
    // Helper: Get random element from array
    function getRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    // State for widget and track
    let widget = null;
    let currentTrack = null;
    let isPlaying = false;
    let tracks = null;

    // Update play/pause icon
    // Unified play/pause icon update function
    function updatePlayPauseIcon() {
      document.getElementById('play-icon').style.display = isPlaying ? 'none' : '';
      document.getElementById('pause-icon').style.display = isPlaying ? '' : 'none';
    }

    // Use a hardcoded list of Sedna FM track URLs for reliability
    function fetchSednaTracks() {
      // Add or update this list with actual Sedna FM track paths as needed
      // Real Sedna FM track URLs (update this list as needed)
      return [
        "https://soundcloud.com/sednafm/november-bomb",
        "https://soundcloud.com/sednafm/destination-sedna",
        "https://soundcloud.com/sednafm/beautiful-as-you-feel",
        "https://soundcloud.com/sednafm/queen-of-spades",
        "https://soundcloud.com/sednafm/on-the-go-zero-zero",
        "https://soundcloud.com/sednafm/morning-drops-timeless-legacy",
        "https://soundcloud.com/sednafm/morning-drops-waves-of-the-maghreb",
        "https://soundcloud.com/sednafm/morning-drops-spaceshift",
        "https://soundcloud.com/sednafm/morning-drops-bars-with-balls",
        "https://soundcloud.com/sednafm/morning-drops-electric-shock",
        "https://soundcloud.com/sednafm/morning-drops-friends-home",
        "https://soundcloud.com/sednafm/morning-drops-secret-mp3-player-1",
        "https://soundcloud.com/sednafm/alters-of-an-ego",
        "https://soundcloud.com/sednafm/morning-drops-unboxing",
        "https://soundcloud.com/sednafm/morning-drops-birthdaycake",
        "https://soundcloud.com/sednafm/morning-drops-the-one-with-many-names",
        "https://soundcloud.com/sednafm/morning-drops-mediterranean-boat",
        "https://soundcloud.com/sednafm/morning-drops-80s-club",
        "https://soundcloud.com/sednafm/morning-drops-demystifying-reggaeton",
        "https://soundcloud.com/sednafm/morning-drops-slow-planet",
        "https://soundcloud.com/sednafm/morning-drops-unfreezing",
        "https://soundcloud.com/sednafm/morning-drops-the-sound-of-tuareg",
        "https://soundcloud.com/sednafm/morning-drops-steel-city",
        "https://soundcloud.com/sednafm/morning-drops-18-sardegna",
        "https://soundcloud.com/sednafm/morning-drops-wabi-sabi"
      ];
      // For a dynamic solution, use the SoundCloud API with a client_id to fetch tracks.
      // See: https://developers.soundcloud.com/docs/api/reference#tracks
    }

    // Embed SoundCloud player for a given track URL
    function embedSoundCloud(trackUrl) {
      const playerDiv = document.getElementById('soundcloud-player');
      playerDiv.innerHTML = `
        <iframe id="sc-widget-iframe" width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay"
          src="https://w.soundcloud.com/player/?url=${encodeURIComponent(trackUrl)}&color=%23ff5500&auto_play=true&hide_related=false&show_comments=false&show_user=true&show_reposts=false&show_teaser=true">
        </iframe>
      `;
      playerDiv.style.display = 'block';

      // Wait for iframe to be in DOM, then instantiate widget
      setTimeout(() => {
        const iframe = document.getElementById('sc-widget-iframe');
        if (iframe) {
          widget = SC.Widget(iframe);
          // Listen for play/pause events to update icon
          widget.bind(SC.Widget.Events.PLAY, function() {
            isPlaying = true;
            updatePlayPauseIcon();
          });
          widget.bind(SC.Widget.Events.PAUSE, function() {
            isPlaying = false;
            updatePlayPauseIcon();
          });
          widget.bind(SC.Widget.Events.FINISH, function() {
            isPlaying = false;
            updatePlayPauseIcon();
          });
        }
      }, 200);
    }

    // Play random Sedna FM episode
    // Play a specific track by URL
    function playTrack(trackUrl) {
      if (!tracks) tracks = fetchSednaTracks();
      if (!widget || currentTrack !== trackUrl) {
        currentTrack = trackUrl;
        embedSoundCloud(trackUrl);
        setTimeout(() => {
          if (widget) widget.load(trackUrl, { auto_play: true });
        }, 500);
      } else {
        widget.play();
      }
    }

    // Play a random track
    function playRandomEpisode() {
      if (!tracks) tracks = fetchSednaTracks();
      const randomTrack = getRandom(tracks);
      playTrack(randomTrack);
    }

    // Play/pause toggle
    function togglePlayPause() {
      if (!widget) {
        playRandomEpisode();
        return;
      }
      widget.isPaused(function(paused) {
        if (paused) {
          widget.play();
        } else {
          widget.pause();
        }
      });
    }

    // Next track
    function playNextTrack() {
      if (!tracks) tracks = fetchSednaTracks();
      let nextTrack;
      if (tracks.length <= 1) {
        nextTrack = tracks[0];
      } else {
        // Find the index of the current track and go to the next one (circular)
        const idx = tracks.indexOf(currentTrack);
        if (idx === -1 || idx === tracks.length - 1) {
          nextTrack = tracks[0];
        } else {
          nextTrack = tracks[idx + 1];
        }
      }
      playTrack(nextTrack);
    }

    // Attach click handler to new play/pause and next buttons
    document.getElementById('radio-play-btn').addEventListener('click', togglePlayPause);
    document.getElementById('radio-next-btn').addEventListener('click', playNextTrack);

    // Update play/pause icon for new button
    // (Removed duplicate updatePlayPauseIcon function)

    // Update artwork and title in overlay
    function updateArtworkAndTitle() {
      if (widget) {
        widget.getCurrentSound(function(sound) {
          // Show overlay only when a track is loaded
          const overlay = document.getElementById('radio-black-overlay');
          if (sound && (sound.artwork_url || sound.title)) {
            overlay.style.display = 'flex';
          } else {
            overlay.style.display = 'none';
          }
          // Artwork
          const artImg = document.getElementById('radio-artwork');
          const artLink = document.getElementById('radio-artwork-link');
          if (sound && sound.artwork_url) {
            let url = sound.artwork_url.replace('-large', '-t500x500');
            artImg.src = url;
            artImg.style.display = '';
          } else {
            artImg.src = 'ale1.jpeg';
            artImg.style.display = '';
          }
          // Make artwork clickable to current track
          if (artLink) {
            artLink.href = currentTrack || "#";
            artLink.style.pointerEvents = currentTrack ? "auto" : "none";
          }
          // Title
          const titleSpan = document.getElementById('radio-title');
          let title = sound && sound.title ? sound.title : '';
          titleSpan.textContent = title;
          // Scrolling effect if too long
          setTimeout(() => {
            const container = document.getElementById('radio-title-container');
            // Remove previous animation
            titleSpan.style.animation = '';
            titleSpan.style.removeProperty('--scroll-distance');
            titleSpan.style.paddingRight = "";
            if (titleSpan.scrollWidth > container.offsetWidth) {
              // Calculate scroll distance
              const scrollDistance = titleSpan.scrollWidth - container.offsetWidth + 40;
              titleSpan.style.setProperty('--scroll-distance', scrollDistance + 'px');
              titleSpan.style.animation = `scroll-title 8s linear infinite`;
              titleSpan.style.paddingRight = "40px";
            }
          }, 100);
        });
      }
    }

    // Update artwork and title when track loads/changes
    function setupArtworkListener() {
      if (widget) {
        widget.bind(SC.Widget.Events.READY, updateArtworkAndTitle);
        widget.bind(SC.Widget.Events.PLAY, updateArtworkAndTitle);
        widget.bind(SC.Widget.Events.LOAD_PROGRESS, updateArtworkAndTitle);
      }
    }

    // Patch embedSoundCloud to call setupArtworkListener after widget is created
    const _origEmbedSoundCloud = embedSoundCloud;
    embedSoundCloud = function(trackUrl) {
      _origEmbedSoundCloud(trackUrl);
      setTimeout(setupArtworkListener, 400);
    };

    // Initialize play/pause icon on load
    updatePlayPauseIcon();
  </script>
  <!-- Subscribe Modal -->
  <div class="modal-overlay" id="subscribe-modal-overlay" tabindex="-1" aria-hidden="true">
    <div class="modal-window" role="dialog" aria-modal="true" aria-labelledby="subscribe-modal-title">
      <button class="modal-close" id="subscribe-modal-close" aria-label="Close">&times;</button>
      <div class="modal-iframe-container">
        <iframe width="520px" height="600px" src="https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=nxO6CWrATE21JQku-8TYZj8EuWgJ7X5GjxrGm2M0ZJBUODVIVk9DT044Q05BSVYxTjQySFNBSkRTSi4u&embed=true"
          frameborder="0" marginwidth="0" marginheight="0"
          style="border: none; max-width:100%; max-height:100vh; width:100%; height:100%; min-height: 600px;"
          allowfullscreen webkitallowfullscreen mozallowfullscreen msallowfullscreen>
        </iframe>
      </div>
      <div class="modal-disclaimer" style="margin-top: 18px; text-align: center; max-width: 75%; margin-left: auto; margin-right: auto; padding: 0 18px;">
        By subscribing, you consent to receive updates regarding new episodes from Sedna FM. You may unsubscribe at any time by following the instructions provided in our communications.
      </div>
    </div>
  </div>
  <script>
    // Modal logic
    (function() {
      const subscribeLink = document.querySelector('.nav-left a[href="#"]');
      const modalOverlay = document.getElementById('subscribe-modal-overlay');
      const modalClose = document.getElementById('subscribe-modal-close');

      // Open modal
      subscribeLink.addEventListener('click', function(e) {
        e.preventDefault();
        modalOverlay.classList.add('active');
        modalOverlay.setAttribute('aria-hidden', 'false');
      });

      // Close modal
      function closeModal() {
        modalOverlay.classList.remove('active');
        modalOverlay.setAttribute('aria-hidden', 'true');
      }
      modalClose.addEventListener('click', closeModal);
      modalOverlay.addEventListener('click', function(e) {
        if (e.target === modalOverlay) closeModal();
      });
      document.addEventListener('keydown', function(e) {
        if (modalOverlay.classList.contains('active') && e.key === 'Escape') closeModal();
      });
    })();
  </script>
</body>
</html>
